{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ù–∞–∫–ª–∞–¥–Ω–æ–π ‚Ññ{{ document.id }}</h3>
    <p><strong>–ü–æ–ª—É—á–∞—Ç–µ–ª—å:</strong> {{ document.destination }}</p>
    <hr>

    <div class="row">
        <div class="col-md-7">
            <div class="card mb-4">
                <div class="card-header">–î–æ–±–∞–≤–∏—Ç—å —É–ø–∞–∫–æ–≤–∫—É –≤ –Ω–∞–∫–ª–∞–¥–Ω—É—é</div>
                <div class="card-body">
                    <form method="post">
                        {% csrf_token %}
                        <div class="input-group">
                            <input type="text" name="shipment_barcode" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–ª–∏ —Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ —à—Ç—Ä–∏—Ö–∫–æ–¥...">
                            <button type="button" class="btn btn-outline-secondary" id="scan-shipment-btn">üì∏</button>
                            <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="card">
                <div class="card-header">–£–ø–∞–∫–æ–≤–∫–∏ –≤ –Ω–∞–∫–ª–∞–¥–Ω–æ–π</div>
                <div class="card-body">
                    {% if document.shipments.all %}
                    <ul class="list-group list-group-flush">
                        {% for shipment in document.shipments.all %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <a href="{% url 'shipment_detail' shipment.pk %}">–û—Ç–≥—Ä—É–∑–∫–∞ ‚Ññ{{ shipment.id }}</a>
                            <span class="badge bg-secondary rounded-pill">{{ shipment.barcode }}</span>
                        </li>
                        {% endfor %}
                    </ul>
                    {% else %}
                    <p class="text-muted">–í –Ω–∞–∫–ª–∞–¥–Ω—É—é –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã —É–ø–∞–∫–æ–≤–∫–∏.</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="col-md-5">
            <div class="card">
                <div class="card-header">–ì–æ—Ç–æ–≤—ã–µ –∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é —É–ø–∞–∫–æ–≤–∫–∏</div>
                <div class="card-body">
                    {% if available_shipments %}
                    <table class="table table-sm">
                        <thead><tr><th>ID</th><th>–ö–æ–ª-–≤–æ</th><th>–î–µ–π—Å—Ç–≤–∏–µ</th></tr></thead>
                        <tbody>
                        {% for shipment in available_shipments %}
                            <tr>
                                <td>{{ shipment.id }}</td>
                                <td>{{ shipment.total_items|default:0 }} —à—Ç.</td>
                                <td>
                                    <form method="post">
                                        {% csrf_token %}
                                        <input type="hidden" name="shipment_id" value="{{ shipment.id }}">
                                        <button type="submit" class="btn btn-sm btn-success">–î–æ–±–∞–≤–∏—Ç—å</button>
                                    </form>
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <p class="text-muted">–ù–µ—Ç –≥–æ—Ç–æ–≤—ã—Ö –∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é —É–ø–∞–∫–æ–≤–æ–∫.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}