{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center">
        <h2>–ù–∞–∫–ª–∞–¥–Ω–∞—è ‚Ññ{{ document.id }}</h2>
        <div>
            <button onclick="window.print()" class="btn btn-outline-secondary">üñ®Ô∏è –ü–µ—á–∞—Ç—å</button>
            <a href="{% url 'shipment_document_list' %}" class="btn btn-secondary">–ö —Å–ø–∏—Å–∫—É</a>
        </div>
    </div>
    <hr>
    <div class="row">
        <div class="col-md-6">
            <p><strong>–ü–æ–ª—É—á–∞—Ç–µ–ª—å:</strong> {{ document.destination }}</p>
        </div>
        <div class="col-md-6 text-md-end">
            <p><strong>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</strong> {{ document.created_at|date:"d.m.Y H:i" }}</p>
            <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span class="badge bg-success">{{ document.get_status_display }}</span></p>
        </div>
    </div>

    <div class="card mt-4">
        <div class="card-header">
            <h4>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–∞–∫–ª–∞–¥–Ω–æ–π</h4>
        </div>
        <div class="card-body">
            <table class="table">
                <thead>
                    <tr>
                        <th>‚Ññ –£–ø–∞–∫–æ–≤–∫–∏</th>
                        <th>–®—Ç—Ä–∏—Ö–∫–æ–¥ —É–ø–∞–∫–æ–≤–∫–∏</th>
                        <th>–¢–æ–≤–∞—Ä</th>
                        <th>–ê—Ä—Ç–∏–∫—É–ª</th>
                        <th>–ö–æ–ª-–≤–æ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for shipment in document.shipments.all %}
                        {% for item in shipment.shipmentitem_set.all %}
                        <tr>
                            {% if forloop.first %}
                            <td rowspan="{{ shipment.shipmentitem_set.count }}">{{ shipment.id }}</td>
                            <td rowspan="{{ shipment.shipmentitem_set.count }}">{{ shipment.package.barcode }}</td>
                            {% endif %}
                            <td>{{ item.product.name }}</td>
                            <td>{{ item.product.sku }}</td>
                            <td>{{ item.quantity }}</td>
                        </tr>
                        {% endfor %}
                    {% empty %}
                        <tr>
                            <td colspan="5" class="text-center">–í –Ω–∞–∫–ª–∞–¥–Ω–æ–π –Ω–µ—Ç —É–ø–∞–∫–æ–≤–æ–∫.</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}