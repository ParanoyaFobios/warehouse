{% extends "base.html" %}
{% block content %}
<main class="main">
    <section class="section catalog-re-accounts container">
    <div class="section__header">
        <h1 class="section__header-title flex-center">
        Переучеты
        <span class="content-size">
            <svg
            width="30"
            height="30"
            viewBox="0 0 30 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            >
            <path
                d="M2.68108 18.0198C2.76845 18.2439 2.67224 18.4979 2.45813 18.6077L1.93618 18.8786L4.64415 20.3382L5.04042 17.252L4.40345 17.586C4.28233 17.6495 4.13948 17.657 4.01233 17.6065C3.88524 17.5561 3.78651 17.4526 3.74192 17.3233L3.62233 16.9761C2.94628 15.0248 2.91546 12.9482 3.53339 10.9714C4.29809 8.52299 5.97118 6.51803 8.2445 5.32606C8.39233 5.24848 8.50138 5.11782 8.5513 4.95844C8.60116 4.7993 8.58599 4.63049 8.50858 4.48319C8.34868 4.17838 7.97005 4.05997 7.66454 4.21934C5.09561 5.56618 3.20485 7.83182 2.3413 10.5984C1.59997 12.9701 1.68194 15.4453 2.57831 17.7565L2.68108 18.0198Z"
                fill="#00A6F2"
            />
            <path
                d="M9.83691 16.9512H11.1192V18.2317H9.83691V16.9512Z"
                fill="#00A6F2"
            />
            <path
                d="M9.83691 20.8906H11.1192V22.1729H9.83691V20.8906Z"
                fill="#00A6F2"
            />
            <path
                d="M9.83691 24.832H11.1192V26.1142H9.83691V24.832Z"
                fill="#00A6F2"
            />
            <path
                d="M19.0654 13.363V10.7873C18.7794 10.7596 18.5003 10.7083 18.2298 10.6357H9.77246V13.363H19.0654Z"
                fill="#00A6F2"
            />
            <path
                d="M23.7956 5.64586C23.7956 3.31459 21.899 1.41797 19.5677 1.41797C17.2365 1.41797 15.3398 3.31459 15.3398 5.64586C15.3398 7.97713 17.2365 9.87375 19.5677 9.87375C21.899 9.87375 23.7956 7.97713 23.7956 5.64586ZM19.5677 5.17664C20.7911 5.17664 21.7493 5.90068 21.7493 6.82512C21.7493 7.62738 21.0273 8.27842 20.0369 8.4365V8.57566C20.0369 8.83482 19.8268 9.04488 19.5677 9.04488C19.3085 9.04488 19.0985 8.83482 19.0985 8.57566V8.4365C18.108 8.27842 17.386 7.62732 17.386 6.82506C17.386 6.5659 17.5961 6.35584 17.8552 6.35584C18.1144 6.35584 18.3244 6.5659 18.3244 6.82506C18.3244 7.14463 18.7873 7.49824 19.4633 7.53182H19.672C20.348 7.49824 20.8109 7.14469 20.8109 6.82506C20.8109 6.48926 20.3003 6.11502 19.5677 6.11502C18.3443 6.11502 17.3861 5.39098 17.3861 4.46654C17.3861 3.66428 18.108 3.01324 19.0985 2.8551V2.71594C19.0985 2.45678 19.3086 2.24672 19.5677 2.24672C19.8269 2.24672 20.037 2.45678 20.037 2.71594V2.8551C21.0274 3.01318 21.7494 3.66428 21.7494 4.46648C21.7494 4.72564 21.5393 4.9357 21.2801 4.9357C21.021 4.9357 20.8109 4.72564 20.8109 4.46648C20.8109 4.13068 20.3003 3.75645 19.5677 3.75645C18.8351 3.75645 18.3245 4.13068 18.3245 4.46648C18.3245 4.80229 18.8351 5.17664 19.5677 5.17664Z"
                fill="#00A6F2"
            />
            <path
                d="M27.3189 12.0028C27.2319 11.7795 27.3271 11.5266 27.5397 11.4161L28.0638 11.1423L25.3558 9.68262L24.9595 12.7689L25.5966 12.4349C25.7178 12.3714 25.8606 12.3639 25.9878 12.4144C26.1148 12.4649 26.2136 12.5684 26.2581 12.6977L26.3776 13.0448C27.0549 14.9957 27.0863 17.0725 26.4683 19.0495C25.777 21.2592 24.3256 23.1297 22.3672 24.3448V25.7843C24.9201 24.4351 26.7993 22.1773 27.6603 19.4222C28.4003 17.05 28.3178 14.5753 27.4216 12.2661L27.3189 12.0028Z"
                fill="#00A6F2"
            />
            <path
                d="M20.0039 13.832C20.0039 14.0912 19.7938 14.3013 19.5347 14.3013H9.3034C9.04424 14.3013 8.83418 14.0912 8.83418 13.832V10.1664C8.83418 9.90721 9.04424 9.69715 9.3034 9.69715H16.3664C15.9298 9.35145 15.5504 8.93672 15.2443 8.46973H8.19228C7.76051 8.46973 7.40918 8.82029 7.40918 9.25119V27.8004C7.40918 28.2313 7.76051 28.5819 8.19228 28.5819H20.6476C21.0785 28.5819 21.429 28.2313 21.429 27.8004V10.4647C20.9807 10.6385 20.5023 10.7512 20.004 10.7931L20.0039 13.832ZM12.0581 26.5829C12.0581 26.8421 11.848 27.0521 11.5888 27.0521H9.3682C9.10904 27.0521 8.89898 26.8421 8.89898 26.5829V24.3623C8.89898 24.1032 9.10904 23.8931 9.3682 23.8931H11.5888C11.848 23.8931 12.0581 24.1032 12.0581 24.3623V26.5829ZM12.0581 22.6416C12.0581 22.9007 11.848 23.1108 11.5888 23.1108H9.3682C9.10904 23.1108 8.89898 22.9007 8.89898 22.6416V20.4209C8.89898 20.1618 9.10904 19.9517 9.3682 19.9517H11.5888C11.848 19.9517 12.0581 20.1618 12.0581 20.4209V22.6416ZM12.0581 18.7002C12.0581 18.9594 11.848 19.1694 11.5888 19.1694H9.3682C9.10904 19.1694 8.89898 18.9594 8.89898 18.7002V16.4812C8.89898 16.2221 9.10904 16.012 9.3682 16.012H11.5888C11.848 16.012 12.0581 16.2221 12.0581 16.4812V18.7002ZM15.9994 26.5829C15.9994 26.8421 15.7894 27.0521 15.5302 27.0521H13.3096C13.0504 27.0521 12.8404 26.8421 12.8404 26.5829V24.3623C12.8404 24.1032 13.0504 23.8931 13.3096 23.8931H15.5302C15.7894 23.8931 15.9994 24.1032 15.9994 24.3623V26.5829ZM15.9994 22.6416C15.9994 22.9007 15.7894 23.1108 15.5302 23.1108H13.3096C13.0504 23.1108 12.8404 22.9007 12.8404 22.6416V20.4209C12.8404 20.1618 13.0504 19.9517 13.3096 19.9517H15.5302C15.7894 19.9517 15.9994 20.1618 15.9994 20.4209V22.6416ZM15.9994 18.7002C15.9994 18.9594 15.7894 19.1694 15.5302 19.1694H13.3096C13.0504 19.1694 12.8404 18.9594 12.8404 18.7002V16.4812C12.8404 16.2221 13.0504 16.012 13.3096 16.012H15.5302C15.7894 16.012 15.9994 16.2221 15.9994 16.4812V18.7002ZM19.9392 26.5829C19.9392 26.8421 19.7291 27.0521 19.4699 27.0521H17.2509C16.9918 27.0521 16.7817 26.8421 16.7817 26.5829V24.3623C16.7817 24.1032 16.9918 23.8931 17.2509 23.8931H19.4699C19.7291 23.8931 19.9392 24.1032 19.9392 24.3623V26.5829ZM19.9392 22.6416C19.9392 22.9007 19.7291 23.1108 19.4699 23.1108H17.2509C16.9918 23.1108 16.7817 22.9007 16.7817 22.6416V20.4209C16.7817 20.1618 16.9918 19.9517 17.2509 19.9517H19.4699C19.7291 19.9517 19.9392 20.1618 19.9392 20.4209V22.6416ZM19.9392 18.7002C19.9392 18.9594 19.7291 19.1694 19.4699 19.1694H17.2509C16.9918 19.1694 16.7817 18.9594 16.7817 18.7002V16.4812C16.7817 16.2221 16.9918 16.012 17.2509 16.012H19.4699C19.7291 16.012 19.9392 16.2221 19.9392 16.4812V18.7002Z"
                fill="#00A6F2"
            />
            <path
                d="M17.7197 20.8906H19.0003V22.1729H17.7197V20.8906Z"
                fill="#00A6F2"
            />
            <path
                d="M13.7783 20.8906H15.0606V22.1729H13.7783V20.8906Z"
                fill="#00A6F2"
            />
            <path
                d="M13.7783 16.9512H15.0606V18.2317H13.7783V16.9512Z"
                fill="#00A6F2"
            />
            <path
                d="M13.7783 24.832H15.0606V26.1142H13.7783V24.832Z"
                fill="#00A6F2"
            />
            <path
                d="M17.7197 24.832H19.0003V26.1142H17.7197V24.832Z"
                fill="#00A6F2"
            />
            <path
                d="M17.7197 16.9512H19.0003V18.2317H17.7197V16.9512Z"
                fill="#00A6F2"
            />
            </svg>
        </span>
        </h1>
        <form action="{% url 'count_start' %}" method="post">
            {% csrf_token %}
        <button type="submit" class="section__header-button button button--orange">
        Новый переучет +
        </button>
        </form>
    </div>
    <div class="tables-cont tables-cont--first-type tables-cont--m-t-10-20">
        <ul class="cont__list">
            {% for count in inventory_counts %}
        <li class="cont__item">
            <article class="table-card-first">
            <h1 class="table-card-first__title">№ {{ count.id }}</h1>
            <table class="table-first">
                <tr
                class="table__row table__row--color table__row--color-string"
                >
                <th>Ответственный</th>
                <td>{{ count.user.username }}</td>
                </tr>
                <tr class="table__row">
                <th>Статус</th>
                <td class="table__status table__status--{% if count.status == 'in_progress' %}bg-warning
                {% elif count.status == 'completed' %}bg-success
                {% else %}bg-secondary{% endif %}">
                    {{ count.get_status_display }}
                </td>
                </tr>
                <tr class="table__row">
                <th>Дата</th>
                <td>{{ count.created_at|date:"d.m.Y H:i" }}</td>
                </tr>
                {% if count.status == 'completed' and perms.inventarization.can_reconcile_inventory %}
                <tr class="table__row">
                <td class="table__td-buttons-cont">
                    <a class="table__color-text" href="{% url 'count_reconcile' count.pk %}">
                    <span class="content-size">
                        <svg
                        width="30"
                        height="30"
                        viewBox="0 0 30 30"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                        >
                        <rect
                            width="30"
                            height="30"
                            rx="3"
                            fill="#F28500"
                            fill-opacity="0.6"
                        />
                        <path
                            d="M22.5531 5.23558L26.7188 4.64516L26.5578 3.28125L15.6866 4.66049V3.28125H14.3134V4.82213L3.28125 6.1241L3.4422 7.48801L7.4469 7.01271V8.86597H3.28125V21.2256H12.9401V8.86597H8.82019V6.85121L14.3134 6.20499V23.9722H12.9401C11.4253 23.9722 10.1935 25.204 10.1935 26.7188H19.8065C19.8065 25.204 18.5747 23.9722 17.0599 23.9722H15.6866V6.04335L21.1798 5.39713V7.49268H17.0599V19.8523H26.7188V7.49268H22.5531V5.23558ZM10.1935 18.479H6.07361V17.1057H10.1935V18.479ZM10.6789 12.7847L7.4469 16.0167L5.58815 14.158L6.55911 13.187L7.4469 14.0748L9.70802 11.8137L10.6789 12.7847ZM23.9264 17.1057H19.8065V15.7324H23.9264V17.1057ZM23.8084 11.3282L22.8374 12.2992L23.8084 13.2702L22.8374 14.2411L21.8665 13.2702L20.8955 14.2411L19.9245 13.2702L20.8955 12.2992L19.9245 11.3282L20.8955 10.3573L21.8665 11.3282L22.8374 10.3573L23.8084 11.3282Z"
                            fill="white"
                        />
                        </svg>
                    </span>
                    <span>Сверка</span>
                    </a>
                </td>
                </tr>
                {% endif %}

                <tr class="table__row">
                <td class="table__td-buttons-cont">
                    <!-- нужно убирать одну из двух кнопок в зависимости от статуса: -->
                    {% if count.status != 'in_progress' %}
                    <a class="width100 button button--blue" href="{% url 'count_work' count.pk %}">
                    Просмотр
                    </a>
                    {% else %}
                    <a href="{% url 'count_work' count.pk %}"
                    class="width100 button button--orange"
                    >
                    Продолжить
                    </a>
                    {% endif %}
                </td>
                </tr>
                
            </table>
            </article>
        </li>
{% endfor %}

        </ul>
        {% if is_paginated %}
          <div class="pagination">
            <!-- для выделения активной кнопки добавляем кнопке класс pagination__button--active -->
            <div class="pagination__block">
              {% if page_obj.has_previous %}
              <a class="pagination__button" href="?page=1">
                <span class="content-size">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M11.8497 17.5C11.859 17.5 11.864 17.4888 11.8572 17.4819L4.37528 10L11.8572 2.51812C11.864 2.51125 11.859 2.5 11.8497 2.5H8.75028L1.38278 9.8675C1.30965 9.94063 1.30965 10.0594 1.38278 10.1325L8.75028 17.5H11.8497Z"
                      fill="white"
                    />
                    <path
                      d="M18.7247 17.5C18.734 17.5 18.739 17.4888 18.7322 17.4819L11.2503 10L18.7322 2.51812C18.739 2.51125 18.734 2.5 18.7247 2.5H15.6253L8.25778 9.8675C8.18465 9.94063 8.18465 10.0594 8.25778 10.1325L15.6253 17.5H18.7247Z"
                      fill="white"
                    />
                  </svg>
                </span>
              </a>
              <a class="pagination__button" href="?page={{ page_obj.previous_page_number }}">
                <span class="content-size">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M14.9903 17.5C14.9997 17.5 15.0047 17.4888 14.9978 17.4819L7.5159 10L14.9978 2.51812C15.0047 2.51125 14.9997 2.5 14.9903 2.5H11.8909L4.5234 9.8675C4.45028 9.94063 4.45028 10.0594 4.5234 10.1325L11.8909 17.5H14.9903Z"
                      fill="white"
                    />
                  </svg>
                </span>
              </a>
              {% endif %}
            </div>
      
        <div class="pagination__block">
        {% for num in page_obj.paginator.page_range %}
        {% if page_obj.number == num %}
              <button
                class="pagination__button pagination__button--active"
                type="button"
              >
                <span class="content-size">{{ num }}</span>
              </button>
              {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
              <a href="?page={{ num }}"
              class="pagination__button pagination__button"
              type="button"
            >
              <span class="content-size">{{ num }}</span>
            </a>
            {% endif %}
            {% endfor %}
        </div>
      
        {% if page_obj.has_next %}
            <div class="pagination__block">
              <a class="pagination__button" href="?page={{ page_obj.next_page_number }}">
                <span class="content-size">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M5.00972 17.5C5.00035 17.5 4.99535 17.4888 5.00222 17.4819L12.4841 10L5.00222 2.51812C4.99535 2.51125 5.00035 2.5 5.00972 2.5H8.1091L15.4766 9.8675C15.5497 9.94063 15.5497 10.0594 15.4766 10.1325L8.1091 17.5H5.00972Z"
                      fill="white"
                    />
                  </svg>
                </span>
              </a>
      
      
              <a class="pagination__button" href="?page={{ page_obj.paginator.num_pages }}">
                <span class="content-size">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M8.15035 17.5C8.14097 17.5 8.13597 17.4888 8.14285 17.4819L15.6247 10L8.14285 2.51812C8.13597 2.51125 8.14097 2.5 8.15035 2.5H11.2497L18.6172 9.8675C18.6903 9.94063 18.6903 10.0594 18.6172 10.1325L11.2497 17.5H8.15035Z"
                      fill="white"
                    />
                    <path
                      d="M1.27535 17.5C1.26597 17.5 1.26097 17.4888 1.26785 17.4819L8.74972 10L1.26785 2.51812C1.26097 2.51125 1.26597 2.5 1.27535 2.5H4.37472L11.7422 9.8675C11.8153 9.94063 11.8153 10.0594 11.7422 10.1325L4.37472 17.5H1.27535Z"
                      fill="white"
                    />
                  </svg>
                </span>
              </a>
            </div>
            {% endif %}
          </div>
          {% endif %}
    </div>
    </section>
</main>
{% endblock %}